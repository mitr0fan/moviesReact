{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Anton\\\\Desktop\\\\React\\\\movies-react\\\\movies-react\\\\src\\\\pages\\\\movie\\\\index.tsx\";\nimport React, { Fragment } from 'react';\nimport { MovieInfo } from '../movie-info/movie-info';\nimport FilmsContent from '../films-content/films-content';\nimport { Footer } from '../../components/footer/footer';\nimport { PageNotFound } from '../page-not-found/page-not-found';\nimport { http } from '../../services/httpRequest';\nimport { CONSTANTS } from '../../constants/constants';\nimport { selectedMovie, getMovies, getUnsortedMovies, changeLoadingStatus } from '../../actions/movies-actions';\nimport { connect } from 'react-redux';\nimport { Loading } from '../../components/loading/loading';\nexport class MovieInfoPage extends React.Component {\n  static getInitialProps({\n    store,\n    query\n  }) {\n    return {\n      store,\n      query\n    };\n  }\n\n  componentDidMount() {\n    if (!this.props.selectedMovie) {\n      const id = this.props.query.id;\n      http(CONSTANTS.URL_FILMS + `/${id}`).then(movie => {\n        if (movie.title) {\n          this.props.dispatch(selectedMovie(movie));\n          const url = `?search=${movie.genres[0]}&searchBy=genres`;\n          http(CONSTANTS.URL_FILMS + url).then(res => {\n            this.props.dispatch(getMovies([...res.data]));\n            this.props.dispatch(getUnsortedMovies([...res.data]));\n          });\n        }\n      }).finally(() => this.props.dispatch(changeLoadingStatus(false)));\n    }\n  }\n\n  backToMainPage() {\n    this.props.dispatch(changeLoadingStatus(false));\n    this.props.dispatch(getUnsortedMovies([...this.props.movies]));\n  }\n\n  loading() {\n    if (this.props.loadingStatus) {\n      return React.createElement(Loading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      });\n    }\n  }\n\n  render() {\n    if (!isNaN(+this.props.query.id)) {\n      return React.createElement(Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }, this.loading(), React.createElement(MovieInfo, {\n        backToMainPage: this.backToMainPage.bind(this),\n        selectedMovie: this.props.selectedMovie,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      }), React.createElement(FilmsContent, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83\n        },\n        __self: this\n      }), React.createElement(Footer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }));\n    } else {\n      return React.createElement(PageNotFound, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      });\n    }\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    selectedMovie: state.selectedMovie,\n    movies: state.movies,\n    loadingStatus: state.loadingStatus\n  };\n}\n\nexport default connect(mapStateToProps)(MovieInfoPage);","map":{"version":3,"sources":["C:/Users/Anton/Desktop/React/movies-react/movies-react/src/pages/movie/index.tsx"],"names":["React","Fragment","MovieInfo","FilmsContent","Footer","PageNotFound","http","CONSTANTS","selectedMovie","getMovies","getUnsortedMovies","changeLoadingStatus","connect","Loading","MovieInfoPage","Component","getInitialProps","store","query","componentDidMount","props","id","URL_FILMS","then","movie","title","dispatch","url","genres","res","data","finally","backToMainPage","movies","loading","loadingStatus","render","isNaN","bind","mapStateToProps","state"],"mappings":"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","sourcesContent":["import React, { Fragment } from 'react';\r\nimport { MovieInfo } from '../movie-info/movie-info';\r\nimport FilmsContent from '../films-content/films-content';\r\nimport { Footer } from '../../components/footer/footer';\r\nimport { PageNotFound } from '../page-not-found/page-not-found';\r\nimport { http } from '../../services/httpRequest';\r\nimport { CONSTANTS } from '../../constants/constants';\r\nimport { Movie } from '../../types/movie';\r\nimport {\r\n    selectedMovie,\r\n    getMovies,\r\n    getUnsortedMovies,\r\n    changeLoadingStatus,\r\n} from '../../actions/movies-actions';\r\nimport { MoviesResponse } from '../../types/httpType';\r\nimport { connect } from 'react-redux';\r\nimport { State } from '../../types/state';\r\nimport { Loading } from '../../components/loading/loading';\r\n\r\ninterface Props {\r\n    selectedMovie: Movie;\r\n    movies: Movie[];\r\n    loadingStatus: boolean;\r\n}\r\n\r\ninterface PropsWithMatch extends Props {\r\n    match: any;\r\n    dispatch: (action: any) => void;\r\n    query: {id: string};\r\n}\r\n\r\nexport class MovieInfoPage extends React.Component<PropsWithMatch> {\r\n\r\n    static getInitialProps({store, query}: any) {\r\n        return {store, query}\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        if (!this.props.selectedMovie) {\r\n            const id = this.props.query.id;\r\n\r\n            http(CONSTANTS.URL_FILMS + `/${id}`)\r\n                .then((movie: Movie) => {\r\n                    if (movie.title) {\r\n                        this.props.dispatch(selectedMovie(movie));\r\n\r\n                        const url = `?search=${movie.genres[0]}&searchBy=genres`;\r\n\r\n                        http(CONSTANTS.URL_FILMS + url).then(\r\n                            (res: MoviesResponse) => {\r\n                                this.props.dispatch(getMovies([...res.data]));\r\n                                this.props.dispatch(\r\n                                    getUnsortedMovies([...res.data])\r\n                                );\r\n                            }\r\n                        );\r\n                    }\r\n                })\r\n                .finally(() => this.props.dispatch(changeLoadingStatus(false)));\r\n        }\r\n    }\r\n\r\n    backToMainPage(): void {\r\n        this.props.dispatch(changeLoadingStatus(false));\r\n        this.props.dispatch(getUnsortedMovies([...this.props.movies]));\r\n    }\r\n\r\n    loading() {\r\n        if(this.props.loadingStatus) {\r\n            return <Loading />\r\n        }\r\n    }\r\n\r\n    render() {\r\n        if (!isNaN(+this.props.query.id)) {\r\n            return (\r\n                <Fragment>\r\n                    {this.loading()}\r\n                    <MovieInfo\r\n                        backToMainPage={this.backToMainPage.bind(this)}\r\n                        selectedMovie={this.props.selectedMovie}\r\n                    />\r\n                    <FilmsContent />\r\n                    <Footer />\r\n                </Fragment>\r\n            );\r\n        } else {\r\n            return <PageNotFound />;\r\n        }\r\n    }\r\n}\r\n\r\nfunction mapStateToProps(state: State): Props {\r\n    return {\r\n        selectedMovie: state.selectedMovie as Movie,\r\n        movies: state.movies,\r\n        loadingStatus: state.loadingStatus\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(MovieInfoPage);\r\n"]},"metadata":{},"sourceType":"module"}